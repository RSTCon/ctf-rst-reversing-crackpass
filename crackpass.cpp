
#include <cstdio>
#include <string>

using namespace std;

// string flag = "RST{93732ff5e18683740582e443e0cc4f6f8201fb9eebf1204537eb05c53ca5be9d}";

string none = "PLM{1111111111111111111111111111111111111111111111111111111111111111}";

unsigned char enc[] = {0x2, 0x1F, 0x19, 0x0, 0x8, 0x2, 0x6, 0x2, 0x3, 0x57, 0x57, 0x4, 
	0x54, 0x0, 0x9, 0x7, 0x9, 0x2, 0x6, 0x5, 0x1, 0x4, 0x9, 0x3, 0x54, 0x5, 0x5, 0x2, 
	0x54, 0x1, 0x52, 0x52, 0x5, 0x57, 0x7, 0x57, 0x9, 0x3, 0x1, 0x0, 0x57, 0x53, 0x8, 
	0x54, 0x54, 0x53, 0x57, 0x0, 0x3, 0x1, 0x5, 0x4, 0x2, 0x6, 0x54, 0x53, 0x1, 0x4, 
	0x52, 0x4, 0x2, 0x52, 0x50, 0x4, 0x53, 0x54, 0x8, 0x55, 0x0};

int main(int argc, char *argv[])
{
	if(argc != 2)
	{
		printf("Format: ./crackpass FLAG\n");
		return 1;
	}
	
	string data = argv[1];
	
	if(data.length() != 69)
	{
		printf("Steagul are 69 de caractere!\n");
		return 2;
	}
	
	for(size_t i = 0; i < data.length(); i++)
	{
		if( (enc[i] ^ (unsigned char)data[i]) != (unsigned char)none[i])
		{
			printf("Steagul este gresit!\n");
			return 3;
		}
	}
	
	printf("Da, acela e steagul!\n");

	return 0;
}
